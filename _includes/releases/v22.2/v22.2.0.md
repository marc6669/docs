## v22.2.0

Release Date: December 6, 2022

With the release of CockroachDB v22.2, we've made a variety of management, performance, security, and compatibility improvements. Check out a [summary of the most significant user-facing changes](#v22-2-0-feature-summary) and then [upgrade to CockroachDB v22.2](../v22.2/upgrade-cockroach-version.html). For a release announcement with further focus on key features, see the [v22.2 blog post](https://www.cockroachlabs.com/blog/cockroachdb-22-2-release/).

We're running a packed [schedule of launch events](https://www.cockroachlabs.com/cockroachdb-22-2-launch/) over the next few weeks, which include two opportunities to win limited-edition swag. Join our [Office Hours session](https://www.cockroachlabs.com/webinars/22-2-release-office-hours/) for all your questions, a [coding livestream](http://twitch.tv/itsaydrian) where we'll play with new features, and a [live talk on building and preparing for scale](https://www.cockroachlabs.com/webinars/scale-happens/).

{% include releases/release-downloads-docker-image.md release=include.release %}

<h3 id="v22-2-0-{{ site.data.products.db | downcase | replace: " ", "-" }}">{{ site.data.products.db }}</h3>

- <a href="https://cockroachlabs.cloud/signup?referralId=docs_crdb_release_notes" rel="noopener" target="_blank">Get a free v22.2 cluster on {{ site.data.products.serverless }}</a>.
- Learn about recent updates to {{ site.data.products.db }} in the [{{ site.data.products.db }} Release Notes](cloud.html).

<h3 id="v22-2-0-feature-summary">Feature summary</h3>

This section summarizes the most significant user-facing changes in v22.2.0. For a complete list of features and changes, including bug fixes and performance improvements, see the [release notes](index.html#testing-releases) for previous testing releases. You can also search for [what's new in v22.2 in our docs](../search.html?query=new%20in%20v22.2).

{{site.data.alerts.callout_info}}
"Core" features are freely available in the core version of CockroachDB and do not require an enterprise license. "Enterprise" features require an [enterprise license](https://www.cockroachlabs.com/get-cockroachdb/enterprise/). [{{ site.data.products.db }} clusters](https://cockroachlabs.cloud/) include all enterprise features. You can also use [`cockroach demo`](../v22.2/cockroach-demo.html) to test enterprise features in a local, temporary cluster.
{{site.data.alerts.end}}

- [SQL](#v22-2-0-sql)
- [Recovery and I/O](#v22-2-0-recovery-and-i-o)
- [Database operations](#v22-2-0-database-operations)
- [Backward-incompatible changes](#v22-2-0-backward-incompatible-changes)
- [Deprecations](#v22-2-0-deprecations)
- [Known limitations](#v22-2-0-known-limitations)
- [Education](#v22-2-0-education)

<style>
    table td:first-child {
        min-width: 100px !important;
    }
    table td:nth-child(2) {
        min-width: 200px !important;
    }
</style>

<h4 id="v22-2-0-sql">SQL</h4>

| Version | Feature | Description |
----------+---------+--------------
| TODO | TODO | TODO |

<h4 id="v22-2-0-developer-experience">Developer Experience</h4>

| Version | Feature | Description |
----------+---------+--------------
| TODO | TODO | TODO |

<h4 id="v22-2-0-recovery-and-i-o">Recovery and I/O</h4>

| Version | Feature | Description |
----------+---------+--------------
| TODO | TODO | TODO |

<h4 id="v22-2-0-database-operations">Database operations</h4>

| Version | Feature | Description |
----------+---------+--------------
| TODO | TODO | TODO |

<h4 id="v22-2-0-security">Security</h4>

| Version | Feature | Description |
----------+---------+--------------
| TODO | TODO | TODO |

<h4 id="v22-2-0-backward-incompatible-changes">Backward-incompatible changes</h4>

Before [upgrading to CockroachDB v22.2](../v22.2/upgrade-cockroach-version.html), be sure to review the following backward-incompatible changes and adjust your deployment as necessary.

{% comment %} All below from 22.2.0-alpha.1 {% endcomment %}

- CockroachDB no longer performs environment variable expansion in the parameter `--certs-dir`. Uses like `--certs-dir='$HOME/path'` (expansion by CockroachDB) can be replaced by `--certs-dir="$HOME/path"` (expansion by the Unix shell). [#81298][#81298]
- In the Cockroach CLI, [`BOOL` values](../{{site.versions["dev"]}}/bool.html) are now formatted as `t` or `f` instead of `True` or `False`. [#81943][#81943]
- Removed the `cockroach quit` command. It has been deprecated since v20.1. To [shut down a node](../{{site.versions["dev"]}}/node-shutdown.html) gracefully, send a `SIGTERM` signal to it. [#82988][#82988]
- Added a cluster version to allow the [Pebble storage engine](../{{site.versions["dev"]}}/architecture/storage-layer.html#pebble) to recombine certain SSTables (specifically, user keys that are split across multiple files in a level of the [log-structured merge-tree](../{{site.versions["dev"]}}/architecture/storage-layer.html#log-structured-merge-trees)). Recombining the split user keys is required for supporting the range keys feature. The migration to recombine the SSTables is expected to be short (split user keys are rare in practice), but will block subsequent migrations until all tables have been recombined. The `storage.marked-for-compaction-files` time series metric can show the progress of the migration. [#84887][#84887]
- Using a single TCP port listener for both RPC (node-node) and SQL client connections is now deprecated. This capability **will be removed** in the next version of CockroachDB. Instead, make one of the following configuration changes to your CockroachDB deployment:
    - Preferred: keep port `26257` for SQL, and allocate a new port, e.g., `26357`, for node-node RPC connections. For example, you might configure a node with the flags `--listen-addr=:26357 --sql-addr=:26257`, where subsequent nodes seeking to join would then use the flag `--join=othernode:26357,othernode:26257`. This will become the default configuration in the next version of CockroachDB. When using this mode of operation, care should be taken to use a `--join` flag that includes both the previous and new port numbers for other nodes, so that no network partition occurs during the upgrade.
    - Optional: keep port `26257` for RPC, and allocate a new port, e.g., `26357`, for SQL connections. For example, you might configure a node with the flags `--listen-addr=:26257 --sql-addr=:26357`. When using this mode of operation, the `--join` flags do not need to be modified. However, SQL client apps or the SQL load balancer configuration (when in use) must be updated to use the new SQL port number. [#85671][#85671]
- If no `nullif` option is specified while using [`IMPORT CSV`](../{{site.versions["dev"]}}/import.html), then a zero-length string in the input is now treated as `NULL`. The quoted empty string in the input is treated as an empty string. Similarly, if `nullif` is specified, then an unquoted value is treated as `NULL`, and a quoted value is treated as that string. These changes were made to make `IMPORT CSV` behave more similarly to `COPY CSV`. If the previous behavior (i.e., treating either quoted or unquoted values that match the `nullif` setting as `NULL`) is desired, you can use the new `allow_quoted_null` option in the `IMPORT` statement. [#84487][#84487]
- [`COPY FROM`](../{{site.versions["dev"]}}/copy-from.html) operations are now atomic by default instead of being segmented into 100 row transactions. Set the `copy_from_atomic_enabled` session setting to `false` for the previous behavior. [#85986][#85986]

<h4 id="v22-2-0-deprecations">Deprecations</h4>

<h4 id="v22-2-0-known-limitations">Known limitations</h4>

For information about new and unresolved limitations in CockroachDB v22.2, with suggested workarounds where applicable, see [Known Limitations](../v22.2/known-limitations.html).

<h4 id="v22-2-0-education">Education</h4>
